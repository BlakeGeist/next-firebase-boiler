{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport firebase from 'firebase/app';\nimport 'firebase/auth';\nimport clientCredentials from '../../..//credentials/client';\nimport Layout from '../../../layouts/Layout';\nimport Router from 'next/router';\nimport { compose, withState } from 'recompose';\nimport AuthForm from '../../../components/AuthForm';\nimport LoadingSpinner from '../../../components/LoadingSpinner';\nimport { connect } from 'react-redux';\n\nvar LoginBase = function LoginBase(_ref) {\n  var setState = _ref.setState,\n      state = _ref.state,\n      dispatch = _ref.dispatch,\n      lang = _ref.lang;\n\n  if (!firebase.apps.length) {\n    firebase.initializeApp(clientCredentials);\n  }\n\n  ;\n  var email = state.email,\n      password = state.password,\n      isLoading = state.isLoading,\n      errorMessage = state.errorMessage;\n\n  var handleChange = function handleChange(event) {\n    var tempObj = _objectSpread({}, state);\n\n    tempObj[event.target.name] = event.target.value;\n    setState(tempObj);\n  };\n\n  function updateState(item, payload) {\n    var tempObj = _objectSpread({}, state);\n\n    tempObj[item] = payload;\n    setState(tempObj);\n  }\n\n  var handleEmailPassAuth = function handleEmailPassAuth(e) {\n    e.preventDefault();\n    updateState('isLoading', true);\n    var email = state.email,\n        password = state.password;\n    firebase.auth().signInWithEmailAndPassword(email, password)[\"catch\"](function (error) {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n      updateState('isLoading', false);\n\n      if (errorCode === 'auth/user-not-found') {\n        errorMessage = 'User not found please register';\n      }\n\n      updateState('errorMessage', errorMessage);\n    });\n  };\n\n  var onAuthStateChange =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(user) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (user && user.uid) {\n                dispatch({\n                  type: 'SET_ITEM',\n                  name: 'user',\n                  payload: user\n                });\n                Router.push(\"/\".concat(lang, \"/dashboard\"));\n              }\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onAuthStateChange(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    var unsubscribe = firebase.auth().onAuthStateChanged(onAuthStateChange);\n    return function () {\n      return unsubscribe();\n    };\n  });\n  return __jsx(Layout, {\n    pageMod: \"about\"\n  }, __jsx(\"h1\", {\n    className: \"jsx-2762284588\"\n  }, \"Login page\"), __jsx(\"p\", {\n    className: \"jsx-2762284588\"\n  }, \"Login page content\"), __jsx(\"div\", {\n    className: \"jsx-2762284588\" + \" \" + \"login-form-wrapper\"\n  }, __jsx(\"div\", {\n    className: \"jsx-2762284588\" + \" \" + \"login-form\"\n  }, __jsx(AuthForm, {\n    errorMessage: errorMessage,\n    email: email,\n    password: password,\n    handleEmailPassAuth: handleEmailPassAuth,\n    handleChange: handleChange\n  }), __jsx(\"div\", {\n    className: \"jsx-2762284588\"\n  }, __jsx(\"button\", {\n    className: \"jsx-2762284588\"\n  }, \"Sign In with Google\"))), __jsx(LoadingSpinner, {\n    isLoading: isLoading\n  })), __jsx(_JSXStyle, {\n    id: \"2762284588\"\n  }, [\".login-form-wrapper.jsx-2762284588{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:50px;position:relative;}\"]));\n};\n\nvar Login = compose(withState('state', 'setState', {\n  email: '',\n  password: '',\n  isLoading: false,\n  errorMessage: ''\n}))(LoginBase);\nexport default connect(function (state) {\n  return state;\n})(Login);","map":null,"metadata":{},"sourceType":"module"}